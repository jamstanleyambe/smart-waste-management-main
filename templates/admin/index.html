{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<a href="#main-content" class="skip-link">Skip to main content</a>
<div class="dashboard-container" id="main-content">
    <div class="dashboard-header">
        <h1>ğŸ¢ Smart Waste Management Dashboard</h1>
        <p class="dashboard-subtitle">Comprehensive overview of your waste management operations</p>
    </div>

    <div class="dashboard-stats">
        <div class="stat-card">
            <div class="stat-icon">ğŸ‘¥</div>
            <h3>Total Users</h3>
            <div class="number">{{ user_count|default:"0" }}</div>
            <div class="label">Registered Users</div>
            <div class="stat-trend positive">{{ active_user_count|default:"0" }} Active</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸ—‘ï¸</div>
            <h3>Total Bins</h3>
            <div class="number">{{ bin_count|default:"0" }}</div>
            <div class="label">Waste Collection Bins</div>
            <div class="stat-trend positive">{{ full_bins|default:"0" }} Full</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸš›</div>
            <h3>Total Trucks</h3>
            <div class="number">{{ truck_count|default:"0" }}</div>
            <div class="label">Collection Vehicles</div>
            <div class="stat-trend positive">{{ active_trucks|default:"0" }} Active</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸ“</div>
            <h3>Dumping Spots</h3>
            <div class="number">{{ dumping_spot_count|default:"0" }}</div>
            <div class="label">Waste Disposal Sites</div>
            <div class="stat-trend positive">{{ avg_fill_level_spots|default:"0" }}% Avg Fill</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸ“Š</div>
            <h3>Avg Fill Level</h3>
            <div class="number">{{ avg_fill_level|default:"0" }}%</div>
            <div class="label">All Bins Average</div>
            <div class="stat-trend neutral">{{ empty_bins|default:"0" }} Empty</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸ”§</div>
            <h3>Roles</h3>
            <div class="number">{{ role_count|default:"0" }}</div>
            <div class="label">User Roles</div>
            <div class="stat-trend neutral">Stable</div>
        </div>
    </div>

    <!-- Additional Statistics Row -->
    <div class="dashboard-stats" style="margin-top: 1rem;">
        <div class="stat-card">
            <div class="stat-icon">âš¡</div>
            <h3>Active Trucks</h3>
            <div class="number">{{ active_trucks|default:"0" }}</div>
            <div class="label">Currently Operating</div>
            <div class="stat-trend positive">On Duty</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">â¸ï¸</div>
            <h3>Idle Trucks</h3>
            <div class="number">{{ idle_trucks|default:"0" }}</div>
            <div class="label">Available for Assignment</div>
            <div class="stat-trend neutral">Standby</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸ”§</div>
            <h3>Maintenance</h3>
            <div class="number">{{ maintenance_trucks|default:"0" }}</div>
            <div class="label">Under Maintenance</div>
            <div class="stat-trend negative">Service</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸ“ˆ</div>
            <h3>Total Capacity</h3>
            <div class="number">{{ total_capacity|default:"0" }}</div>
            <div class="label">Dumping Spots (Avg)</div>
            <div class="stat-trend neutral">Tons</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸ”„</div>
            <h3>Recent Activity</h3>
            <div class="number">{{ recent_bins|default:"0" }}</div>
            <div class="label">Bins Updated (7 days)</div>
            <div class="stat-trend positive">Active</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">ğŸ“Š</div>
            <h3>System Health</h3>
            <div class="number">{{ role_count|default:"0" }}</div>
            <div class="label">Active Roles</div>
            <div class="stat-trend neutral">Stable</div>
        </div>
    </div>

    <div class="module quick-actions-module">
        <h2>ğŸš€ Quick Actions</h2>
        <p class="module-description">Manage your waste management system efficiently</p>
        <div class="user-actions">
            <a href="{% url 'admin:core_role_add' %}" class="button">ğŸ‘¥ Add New Role</a>
            <a href="{% url 'admin:core_bin_add' %}" class="button">ğŸ—‘ï¸ Add New Bin</a>
            <a href="{% url 'admin:core_truck_add' %}" class="button">ğŸš› Add New Truck</a>
            <a href="{% url 'admin:core_dumpingspot_add' %}" class="button">ğŸ“ Add Dumping Spot</a>
            <a href="{% url 'user_dashboard' %}" class="button">ğŸ” User Management</a>
        </div>
    </div>

    <!-- Enhanced Core Section -->
    <div class="core-section">
        <div class="section-header">
            <h2>ğŸ”§ Core Management</h2>
            <p class="section-description">Manage your waste management system's core components with advanced tools and insights</p>
            <div class="section-stats">
                <div class="stat-item">
                    <span class="stat-number">{{ app_list|length }}</span>
                    <span class="stat-label">Applications</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">{{ app_list|length|add:"0" }}</span>
                    <span class="stat-label">Total Models</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">100%</span>
                    <span class="stat-label">System Health</span>
                </div>
            </div>
        </div>
        
        <div class="core-grid">
            {% if app_list %}
                {% for app in app_list %}
                    <div class="core-module">
                        <div class="module-header">
                            <div class="module-icon">
                                {% if app.name == "Core" %}
                                    âš™ï¸
                                {% elif app.name == "Authentication and Authorization" %}
                                    ğŸ”
                                {% else %}
                                    ğŸ“±
                                {% endif %}
                            </div>
                            <h3 class="module-title">{{ app.name }}</h3>
                            <div class="module-badge">{{ app.models|length }} Models</div>
                        </div>
                        
                        {% if app.models %}
                            <div class="models-container">
                                {% for model in app.models %}
                                    <div class="model-card">
                                        <div class="model-info">
                                            <div class="model-icon">
                                                {% if "bin" in model.name|lower %}
                                                    ğŸ—‘ï¸
                                                {% elif "truck" in model.name|lower %}
                                                    ğŸš›
                                                {% elif "dumping" in model.name|lower %}
                                                    ğŸ“
                                                {% elif "role" in model.name|lower %}
                                                    ğŸ‘¥
                                                {% elif "user" in model.name|lower %}
                                                    ğŸ‘¤
                                                {% else %}
                                                    ğŸ“‹
                                                {% endif %}
                                            </div>
                                            <div class="model-details">
                                                <h4 class="model-name">{{ model.name }}</h4>
                                                <p class="model-description">
                                                    {% if "bin" in model.name|lower %}
                                                        Waste collection bin management
                                                    {% elif "truck" in model.name|lower %}
                                                        Fleet vehicle management
                                                    {% elif "dumping" in model.name|lower %}
                                                        Waste disposal site management
                                                    {% elif "role" in model.name|lower %}
                                                        User role and permission management
                                                    {% elif "user" in model.name|lower %}
                                                        User account management
                                                    {% else %}
                                                        System component management
                                                    {% endif %}
                                                </p>
                                            </div>
                                        </div>
                                        
                                        <div class="model-actions">
                                            {% if model.add_url %}
                                                <a href="{{ model.add_url }}" class="action-btn add-btn" title="Add new {{ model.name }}">
                                                    <span class="btn-icon">â•</span>
                                                    <span class="btn-text">Add</span>
                                                </a>
                                            {% endif %}
                                            
                                            {% if model.admin_url %}
                                                <a href="{{ model.admin_url }}" class="action-btn manage-btn" title="Manage {{ model.name }}">
                                                    <span class="btn-icon">âš™ï¸</span>
                                                    <span class="btn-text">Manage</span>
                                                </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="no-models">
                                <div class="no-models-icon">ğŸ“­</div>
                                <p>No models available for this application.</p>
                            </div>
                        {% endif %}
                    </div>
                {% endfor %}
            {% else %}
                <div class="no-apps">
                    <div class="no-apps-icon">ğŸš«</div>
                    <h3>No Applications Available</h3>
                    <p>There are no applications configured in your Django project.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
