{% extends "admin/base_site.html" %}
{% load i18n %}

{% block content %}
<a href="#main-content" class="skip-link">Skip to main content</a>
<div class="dashboard-container" id="main-content">
    <div class="dashboard-header">
        <h1>🏢 Smart Waste Management Dashboard</h1>
        <p class="dashboard-subtitle">Comprehensive overview of your waste management operations</p>
    </div>

    <div class="dashboard-stats">
        <div class="stat-card">
            <div class="stat-icon">👥</div>
            <h3>Total Users</h3>
            <div class="number">{{ user_count|default:"0" }}</div>
            <div class="label">Registered Users</div>
            <div class="stat-trend positive">{{ active_user_count|default:"0" }} Active</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">🗑️</div>
            <h3>Total Bins</h3>
            <div class="number">{{ bin_count|default:"0" }}</div>
            <div class="label">Waste Collection Bins</div>
            <div class="stat-trend positive">{{ full_bins|default:"0" }} Full</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">🚛</div>
            <h3>Total Trucks</h3>
            <div class="number">{{ truck_count|default:"0" }}</div>
            <div class="label">Collection Vehicles</div>
            <div class="stat-trend positive">{{ active_trucks|default:"0" }} Active</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">📍</div>
            <h3>Dumping Spots</h3>
            <div class="number">{{ dumping_spot_count|default:"0" }}</div>
            <div class="label">Waste Disposal Sites</div>
            <div class="stat-trend positive">{{ avg_fill_level_spots|default:"0" }}% Avg Fill</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">📊</div>
            <h3>Avg Fill Level</h3>
            <div class="number">{{ avg_fill_level|default:"0" }}%</div>
            <div class="label">All Bins Average</div>
            <div class="stat-trend neutral">{{ empty_bins|default:"0" }} Empty</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">🔧</div>
            <h3>Roles</h3>
            <div class="number">{{ role_count|default:"0" }}</div>
            <div class="label">User Roles</div>
            <div class="stat-trend neutral">Stable</div>
        </div>
    </div>

    <!-- Additional Statistics Row -->
    <div class="dashboard-stats" style="margin-top: 1rem;">
        <div class="stat-card">
            <div class="stat-icon">⚡</div>
            <h3>Active Trucks</h3>
            <div class="number">{{ active_trucks|default:"0" }}</div>
            <div class="label">Currently Operating</div>
            <div class="stat-trend positive">On Duty</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">⏸️</div>
            <h3>Idle Trucks</h3>
            <div class="number">{{ idle_trucks|default:"0" }}</div>
            <div class="label">Available for Assignment</div>
            <div class="stat-trend neutral">Standby</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">🔧</div>
            <h3>Maintenance</h3>
            <div class="number">{{ maintenance_trucks|default:"0" }}</div>
            <div class="label">Under Maintenance</div>
            <div class="stat-trend negative">Service</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">📈</div>
            <h3>Total Capacity</h3>
            <div class="number">{{ total_capacity|default:"0" }}</div>
            <div class="label">Dumping Spots (Avg)</div>
            <div class="stat-trend neutral">Tons</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">🔄</div>
            <h3>Recent Activity</h3>
            <div class="number">{{ recent_bins|default:"0" }}</div>
            <div class="label">Bins Updated (7 days)</div>
            <div class="stat-trend positive">Active</div>
        </div>
        
        <div class="stat-card">
            <div class="stat-icon">📊</div>
            <h3>System Health</h3>
            <div class="number">{{ role_count|default:"0" }}</div>
            <div class="label">Active Roles</div>
            <div class="stat-trend neutral">Stable</div>
        </div>
    </div>

    <div class="module quick-actions-module">
        <h2>🚀 Quick Actions</h2>
        <p class="module-description">Manage your waste management system efficiently</p>
        <div class="user-actions">
            <a href="{% url 'admin:core_role_add' %}" class="button">👥 Add New Role</a>
            <a href="{% url 'admin:core_bin_add' %}" class="button">🗑️ Add New Bin</a>
            <a href="{% url 'admin:core_truck_add' %}" class="button">🚛 Add New Truck</a>
            <a href="{% url 'admin:core_dumpingspot_add' %}" class="button">📍 Add Dumping Spot</a>
            <a href="{% url 'user_dashboard' %}" class="button">🔐 User Management</a>
        </div>
    </div>

    <div class="app-list">
        {% if app_list %}
            {% for app in app_list %}
                <div class="module">
                    <h2>{{ app.name }}</h2>
                    {% if app.models %}
                        <table>
                            <thead>
                                <tr>
                                    <th>Model name</th>
                                    <th>Add link</th>
                                    <th>Change or view list link</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for model in app.models %}
                                    <tr>
                                        <td>{{ model.name }}</td>
                                        <td>
                                            {% if model.add_url %}
                                                <a href="{{ model.add_url }}">Add</a>
                                            {% else %}
                                                &nbsp;
                                            {% endif %}
                                        </td>
                                        <td>
                                            {% if model.admin_url %}
                                                <a href="{{ model.admin_url }}">Change</a>
                                            {% else %}
                                                &nbsp;
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    {% else %}
                        <p>No models available.</p>
                    {% endif %}
                </div>
            {% endfor %}
        {% else %}
            <p>No apps available.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
